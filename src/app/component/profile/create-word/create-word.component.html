<section class="create__word_section">
  <h3 class="title">Create Word</h3>
  <form *ngIf="languages !== undefined" [formGroup]="createWordForm" #form="ngForm" (ngSubmit)="form.valid && create()">
    <div class="create__word_form">
      <div formGroupName="languageFrom">
        <div class="language__field_block">
          <h3><span class="flag-icon flag-icon-{{createWordForm?.value?.languageFrom?.language?.code}}"></span>
            {{createWordForm?.value?.languageFrom?.language?.name}}
          </h3>
          <mat-form-field appearance="fill">
            <mat-label>From Language</mat-label>
            <mat-select formControlName="language" (selectionChange)="selectLanguageFrom($event)">
              <mat-option *ngFor="let language of languagesFrom" [value]="language">{{language.name}}</mat-option>
            </mat-select>
            <mat-error *ngIf="createWordForm.get('languageFrom.code')?.hasError('required')">
              Language is <strong>required</strong>
            </mat-error>
          </mat-form-field>
        </div>
        <div>
          <div formArrayName="words">
            <ng-container *ngFor="let word of languagesFromControls.controls; let i = index">
              <div [formGroupName]="i">
                <mat-form-field class="word__field" appearance="fill">
                  <mat-label>Word</mat-label>
                  <textarea formControlName="word" matInput cdkTextareaAutosize #autosize="cdkTextareaAutosize"
                    cdkAutosizeMinRows="1" cdkAutosizeMaxRows="5"></textarea>
                  <mat-error *ngIf="word.get('word')?.hasError('required')">
                    Word is <strong>required</strong>
                  </mat-error>
                  <mat-error *ngIf="word.get('word')?.hasError('minlength')">
                    Word min lengths is <strong>1</strong>
                  </mat-error>
                  <mat-error *ngIf="word.get('word')?.hasError('maxlength')">
                    Word max lengths is <strong>500</strong>
                  </mat-error>
                </mat-form-field>
              </div>
            </ng-container>
            <div class="add__button_block">
              <button mat-stroked-button (click)="addWord($event)" color="add-word">Add word</button>
            </div>
          </div>
        </div>
        <button mat-stroked-button color="primary" type="submit">Create</button>
      </div>
      <div formArrayName="languagesTo">
        <button (click)="addNewLanguage($event)" mat-mini-fab color="primary" aria-label="Add language button"
          class="add__language_btn" [disabled]="currentAddLanguagesLength >= languages.length-1">
          <mat-icon>add</mat-icon>
        </button>
        <div class="translate__block" *ngFor="let languageTo of languagesToControls.controls; let i = index"
          [formGroupName]="i">
          <div class="language__field_block">
            <h3>
              <span *ngIf="languageTo?.value?.language">
                <span class="flag-icon flag-icon-{{languageTo?.value?.language?.code}}"></span>
                {{languageTo?.value?.language?.name}}
              </span>
              <span *ngIf="!languageTo?.value?.language?.name">
                Choose Language
              </span>
            </h3>
            <mat-form-field appearance="fill">
              <mat-label>Language</mat-label>
              <mat-select formControlName="language" (selectionChange)="selectLanguageTo($event, i)">
                <mat-option *ngFor="let language of createWordForm.get('languagesTo.'+i+'.languages')?.value"
                  [value]="language">{{language.name}}</mat-option>
              </mat-select>
              <pre></pre>
              <mat-error *ngIf="languageTo.get('language')?.valid">
                Language is <strong>required</strong>
              </mat-error>
            </mat-form-field>
          </div>
          <div formArrayName="words">
            <div [formGroupName]="j" *ngFor="let word of getWordsToControl(i).controls let j = index">
              <mat-form-field class="word__field" appearance="fill">
                <mat-label>Word</mat-label>
                <textarea formControlName="word" matInput cdkTextareaAutosize #autosize="cdkTextareaAutosize"
                  cdkAutosizeMinRows="1" cdkAutosizeMaxRows="5"></textarea>
                <mat-error *ngIf="languageTo.get('words.'+j+'.word')?.hasError('required')">
                  Word is <strong>required</strong>
                </mat-error>
                <mat-error *ngIf="languageTo.get('words.'+j+'.word')?.hasError('minlength')">
                  Word min lengths is <strong>1</strong>
                </mat-error>
                <mat-error *ngIf="languageTo.get('words.'+j+'.word')?.hasError('maxlength')">
                  Word max lengths is <strong>500</strong>
                </mat-error>
              </mat-form-field>
            </div>
            <div class="add__button_block">
              <button mat-stroked-button (click)="addWordToTranslatedLanguage($event, i)" color="add-word">Add word</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>
</section>
